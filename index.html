<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DiverS - –ú–∞–≥–∞–∑–∏–Ω –∏–≥—Ä–æ–≤—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤ TimeZero</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è Excel —Ñ–∞–π–ª–æ–≤ -->
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary-color: #0a192f;
            --secondary-color: #00a8ff;
            --accent-color: #ff6b6b;
            --dark-bg: #1a3a5f;
            --text-color: #ffffff;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a192f 0%, #1a3a5f 100%);
            color: var(--text-color);
            min-height: 100vh;
            background-attachment: fixed;
        }
        
        .content-wrapper {
            position: relative;
            z-index: 1;
        }
        
        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .navbar {
            background: rgba(10, 25, 47, 0.95) !important;
            backdrop-filter: blur(10px);
            border-bottom: 2px solid var(--secondary-color);
            padding: 15px 0;
            transition: all 0.3s ease;
        }
        
        .navbar-brand {
            color: var(--secondary-color) !important;
            font-weight: bold;
            font-size: 1.5rem;
        }
        
        .nav-link {
            color: #ffffff !important;
            margin: 0 10px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .nav-link:hover {
            color: var(--secondary-color) !important;
            transform: translateY(-2px);
        }
        
        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏–≥—Ä—ã */
        .game-header {
            background: url('https://images.unsplash.com/photo-1534423861386-85a16f5d13fd?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80') center/cover no-repeat;
            padding: 120px 20px;
            text-align: center;
            position: relative;
            border-bottom: 3px solid var(--secondary-color);
        }
        
        .game-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(10, 25, 47, 0.85);
        }
        
        .game-header .container {
            position: relative;
            z-index: 1;
        }
        
        /* –ö–Ω–æ–ø–∫–∏ */
        .btn-game {
            background: linear-gradient(45deg, var(--secondary-color), #0097e6);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 168, 255, 0.3);
        }
        
        .btn-game:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 168, 255, 0.4);
            color: white;
        }
        
        /* –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ */
        .category-filter {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
            border: 1px solid rgba(0, 168, 255, 0.2);
        }
        
        .category-btn {
            background: transparent;
            border: 2px solid var(--secondary-color);
            color: var(--secondary-color);
            padding: 8px 20px;
            margin: 5px;
            border-radius: 25px;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .category-btn:hover,
        .category-btn.active {
            background: var(--secondary-color);
            color: white;
        }
        
        /* –ö–∞—Ä—Ç–æ—á–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤ */
        .product-card {
            background: rgba(30, 42, 71, 0.9);
            border-radius: 12px;
            overflow: hidden;
            border: 2px solid rgba(0, 168, 255, 0.3);
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        .product-card:hover {
            transform: translateY(-5px);
            border-color: var(--secondary-color);
            box-shadow: 0 10px 30px rgba(0, 168, 255, 0.2);
        }
        
        .product-img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-bottom: 2px solid var(--secondary-color);
        }
        
        .category-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            color: white;
        }
        
        .price-tag {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--secondary-color);
        }
        
        .currency-coin {
            color: gold;
            margin-left: 5px;
        }
        
        /* –ö–æ—Ä–∑–∏–Ω–∞ */
        .cart-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(0, 168, 255, 0.2);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }
        
        .cart-item:hover {
            border-color: var(--secondary-color);
            transform: translateX(5px);
        }
        
        .empty-cart {
            text-align: center;
            padding: 50px 20px;
        }
        
        .empty-cart-icon {
            font-size: 4rem;
            color: var(--secondary-color);
            margin-bottom: 20px;
        }
        
        .cart-badge {
            position: relative;
            top: -8px;
            left: -5px;
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal-content {
            background: var(--primary-color);
            border: 2px solid var(--secondary-color);
            border-radius: 15px;
            color: white;
        }
        
        .modal-header {
            border-bottom: 1px solid rgba(0, 168, 255, 0.3);
        }
        
        .modal-footer {
            border-top: 1px solid rgba(0, 168, 255, 0.3);
        }
        
        /* –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å */
        .admin-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--secondary-color), #0097e6);
            color: white;
            border: none;
            font-size: 24px;
            cursor: pointer;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 20px rgba(0, 168, 255, 0.4);
            transition: all 0.3s ease;
        }
        
        .admin-btn:hover {
            transform: scale(1.1) rotate(90deg);
            box-shadow: 0 6px 30px rgba(0, 168, 255, 0.6);
        }
        
        .admin-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 999;
            display: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .admin-overlay.active {
            display: block;
            opacity: 1;
        }
        
        .admin-panel {
            position: fixed;
            top: 0;
            right: 0;
            width: 400px;
            height: 100%;
            background: var(--primary-color);
            z-index: 1000;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            border-left: 2px solid var(--secondary-color);
            overflow-y: auto;
        }
        
        .admin-panel.active {
            transform: translateX(0);
        }
        
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--accent-color);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .order-notification {
            position: fixed;
            bottom: 30px;
            left: 30px;
            background: rgba(30, 42, 71, 0.95);
            border: 2px solid var(--secondary-color);
            border-radius: 12px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            z-index: 1000;
            max-width: 400px;
            animation: slideIn 0.5s ease;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(-100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        /* –°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–æ–≤ */
        .order-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(0, 168, 255, 0.2);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .status-badge {
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .status-pending {
            background: rgba(243, 156, 18, 0.2);
            color: #f39c12;
        }
        
        .status-completed {
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
        }
        
        /* Telegram —Å—Ç–∞—Ç—É—Å */
        .telegram-status {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .telegram-status.connected {
            background: rgba(46, 204, 113, 0.1);
            border: 2px solid #2ecc71;
        }
        
        .telegram-status.disconnected {
            background: rgba(231, 76, 60, 0.1);
            border: 2px solid #e74c3c;
        }
        
        .telegram-icon {
            color: #0088cc;
            font-size: 24px;
        }
        
        /* –°–ø–∏–Ω–Ω–µ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ */
        .spinner-border {
            width: 3rem;
            height: 3rem;
        }
        
        /* –§–æ—Ä–º—ã */
        .form-control {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(0, 168, 255, 0.3);
            color: white;
        }
        
        .form-control:focus {
            background: rgba(255, 255, 255, 0.15);
            border-color: var(--secondary-color);
            color: white;
            box-shadow: 0 0 0 0.25rem rgba(0, 168, 255, 0.25);
        }
        
        .form-label {
            color: var(--secondary-color);
            font-weight: 500;
        }
        
        .input-group-text {
            background: rgba(0, 168, 255, 0.2);
            border: 1px solid rgba(0, 168, 255, 0.3);
            color: white;
        }
        
        /* –ó–∞–≥—Ä—É–∑–∫–∞ Excel —Ñ–∞–π–ª–∞ */
        .excel-upload-area {
            border: 3px dashed var(--secondary-color);
            border-radius: 15px;
            padding: 40px 20px;
            text-align: center;
            background: rgba(0, 168, 255, 0.05);
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 20px;
        }
        
        .excel-upload-area:hover {
            background: rgba(0, 168, 255, 0.1);
            border-color: #0097e6;
        }
        
        .excel-upload-area.dragover {
            background: rgba(0, 168, 255, 0.2);
            border-color: #00c8ff;
            transform: scale(1.02);
        }
        
        .excel-upload-icon {
            font-size: 48px;
            color: var(--secondary-color);
            margin-bottom: 15px;
        }
        
        .excel-preview {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
            border: 1px solid rgba(0, 168, 255, 0.3);
            border-radius: 10px;
            padding: 10px;
        }
        
        .excel-table {
            width: 100%;
            color: white;
            font-size: 12px;
        }
        
        .excel-table th {
            background: rgba(0, 168, 255, 0.3);
            padding: 8px;
            position: sticky;
            top: 0;
        }
        
        .excel-table td {
            padding: 6px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .excel-table tr:hover {
            background: rgba(0, 168, 255, 0.1);
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .admin-panel {
                width: 100%;
            }
            
            .game-header {
                padding: 80px 20px;
            }
            
            .order-notification {
                left: 10px;
                right: 10px;
                max-width: none;
            }
            
            .category-btn {
                padding: 6px 15px;
                font-size: 14px;
            }
        }
        
        /* –ö–∞—Å—Ç–æ–º–Ω—ã–π —Å–∫—Ä–æ–ª–ª–±–∞—Ä */
        ::-webkit-scrollbar {
            width: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--secondary-color);
            border-radius: 5px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #0097e6;
        }
    </style>
</head>
<body>
    <!-- –û–≤–µ—Ä–ª–µ–π –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ -->
    <div class="admin-overlay" id="admin-overlay"></div>
    
    <!-- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å -->
    <div class="admin-panel" id="admin-panel">
        <div class="p-4">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h4 style="color: var(--secondary-color);">
                    <i class="fas fa-cogs me-2"></i>–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
                </h4>
                <button class="btn btn-sm btn-outline-danger" onclick="closeAdminPanel()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <!-- –°—Ç–∞—Ç—É—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
            <div id="admin-auth-section">
                <div class="text-center mb-4">
                    <h5>–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h5>
                    <p class="text-muted small">–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é —Ç–æ–≤–∞—Ä–∞–º–∏</p>
                </div>
                
                <div class="mb-3">
                    <label for="admin-username" class="form-label">–õ–æ–≥–∏–Ω</label>
                    <div class="input-group">
                        <span class="input-group-text"><i class="fas fa-user"></i></span>
                        <input type="text" class="form-control" id="admin-username" placeholder="–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω">
                    </div>
                </div>
                
                <div class="mb-4">
                    <label for="admin-password" class="form-label">–ü–∞—Ä–æ–ª—å</label>
                    <div class="input-group">
                        <span class="input-group-text"><i class="fas fa-key"></i></span>
                        <input type="password" class="form-control" id="admin-password" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
                    </div>
                </div>
                
                <button class="btn btn-game w-100 mb-3" onclick="adminLogin()">
                    <i class="fas fa-sign-in-alt me-2"></i>–í–æ–π—Ç–∏
                </button>
            </div>
            
            <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏ –∏ –∑–∞–∫–∞–∑–∞–º–∏ (–ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏) -->
            <div id="admin-controls" style="display: none;">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h5>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–æ–º</h5>
                    <button class="btn btn-sm btn-outline-warning" onclick="adminLogout()">
                        <i class="fas fa-sign-out-alt me-1"></i>–í—ã–π—Ç–∏
                    </button>
                </div>
                
                <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º -->
                <ul class="nav nav-tabs mb-3" id="adminTabs">
                    <li class="nav-item">
                        <button class="nav-link active" onclick="showAdminTab('products')">
                            <i class="fas fa-box me-1"></i>–¢–æ–≤–∞—Ä—ã
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link" onclick="showAdminTab('orders')">
                            <i class="fas fa-shopping-cart me-1"></i>–ó–∞–∫–∞–∑—ã
                            <span class="badge bg-danger ms-1" id="orders-count-badge">0</span>
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link" onclick="showAdminTab('excel')">
                            <i class="fas fa-file-excel me-1"></i>Excel –∏–º–ø–æ—Ä—Ç
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link" onclick="showAdminTab('telegram')">
                            <i class="fab fa-telegram me-1"></i>Telegram
                        </button>
                    </li>
                </ul>
                
                <!-- –í–∫–ª–∞–¥–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ -->
                <div id="admin-products-tab" class="admin-tab-content">
                    <div class="admin-stats mb-4">
                        <div class="row">
                            <div class="col-6 mb-2">
                                <div class="product-card text-center p-2">
                                    <small>–¢–æ–≤–∞—Ä–æ–≤</small>
                                    <h6 id="admin-total-products">0</h6>
                                </div>
                            </div>
                            <div class="col-6 mb-2">
                                <div class="product-card text-center p-2">
                                    <small>–ö–∞—Ç–µ–≥–æ—Ä–∏–π</small>
                                    <h6 id="admin-total-categories">0</h6>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <button class="btn btn-game w-100 mb-2" onclick="showAddProductModal()">
                            <i class="fas fa-plus me-2"></i>–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä
                        </button>
                        
                        <button class="btn btn-outline-secondary w-100 mb-2" onclick="loadProducts()">
                            <i class="fas fa-sync me-2"></i>–û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫
                        </button>
                    </div>
                    
                    <!-- –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
                    <div class="mt-4">
                        <h6>–¢–æ–≤–∞—Ä—ã</h6>
                        <div class="list-group" id="quick-products-list" style="max-height: 300px; overflow-y: auto;">
                            <!-- –¢–æ–≤–∞—Ä—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                        </div>
                    </div>
                </div>
                
                <!-- –í–∫–ª–∞–¥–∫–∞ –∑–∞–∫–∞–∑–æ–≤ -->
                <div id="admin-orders-tab" class="admin-tab-content" style="display: none;">
                    <div class="mb-3">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <h6>–í—Å–µ –∑–∞–∫–∞–∑—ã</h6>
                        </div>
                    </div>
                    
                    <div id="orders-list-container" style="max-height: 400px; overflow-y: auto;">
                        <!-- –°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                    </div>
                </div>
                
                <!-- –í–∫–ª–∞–¥–∫–∞ Excel –∏–º–ø–æ—Ä—Ç–∞ -->
                <div id="admin-excel-tab" class="admin-tab-content" style="display: none;">
                    <div class="product-card p-3 mb-3">
                        <h6 class="mb-3">
                            <i class="fas fa-file-excel excel-icon me-2" style="color: #217346;"></i>–ò–º–ø–æ—Ä—Ç —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ Excel
                        </h6>
                        
                        <div class="alert alert-info mb-3">
                            <i class="fas fa-info-circle me-2"></i>
                            <small>
                                <b>–§–æ—Ä–º–∞—Ç Excel —Ñ–∞–π–ª–∞:</b><br>
                                ‚Ä¢ –°—Ç–æ–ª–±—Ü—ã: <code>id, name, description, price, category, image, features</code><br>
                                ‚Ä¢ <code>features</code> - —á–µ—Ä–µ–∑ —Ç–æ—á–∫—É —Å –∑–∞–ø—è—Ç–æ–π<br>
                                ‚Ä¢ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏: armor, weapons, medicine, attachments, ammo, throwable<br>
                                ‚Ä¢ <a href="javascript:void(0);" onclick="downloadExcelTemplate()">–°–∫–∞—á–∞—Ç—å —à–∞–±–ª–æ–Ω Excel</a>
                            </small>
                        </div>
                        
                        <!-- –û–±–ª–∞—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ -->
                        <div class="excel-upload-area" id="excel-drop-area" 
                             onclick="document.getElementById('excel-file-input').click()">
                            <i class="fas fa-file-excel excel-upload-icon"></i>
                            <h6>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ Excel —Ñ–∞–π–ª —Å—é–¥–∞</h6>
                            <p class="text-muted small">–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞</p>
                            <small class="text-muted">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ñ–∞–π–ª—ã .xlsx, .xls, .csv</small>
                        </div>
                        
                        <input type="file" id="excel-file-input" accept=".xlsx,.xls,.csv" 
                               style="display: none;" onchange="handleExcelFileSelect(event)">
                        
                        <!-- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö -->
                        <div id="excel-preview-container" style="display: none;">
                            <h6 class="mt-4 mb-2">–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö</h6>
                            <div class="excel-preview">
                                <table class="excel-table" id="excel-preview-table">
                                    <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                                </table>
                            </div>
                            
                            <div class="mt-3">
                                <button class="btn btn-game w-100 mb-2" onclick="importExcelData()">
                                    <i class="fas fa-upload me-2"></i>–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
                                </button>
                                <button class="btn btn-outline-secondary w-100" onclick="clearExcelPreview()">
                                    <i class="fas fa-times me-2"></i>–û—á–∏—Å—Ç–∏—Ç—å
                                </button>
                            </div>
                        </div>
                        
                        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ -->
                        <div id="import-stats" class="mt-3" style="display: none;">
                            <div class="alert alert-success">
                                <i class="fas fa-check-circle me-2"></i>
                                <span id="import-message">–ò–º–ø–æ—Ä—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- –í–∫–ª–∞–¥–∫–∞ Telegram -->
                <div id="admin-telegram-tab" class="admin-tab-content" style="display: none;">
                    <div class="product-card p-3 mb-3">
                        <h6 class="mb-3">
                            <i class="fab fa-telegram telegram-icon me-2"></i>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram
                        </h6>
                        
                        <div class="telegram-status" id="telegram-status">
                            <i class="fab fa-telegram"></i>
                            <div>
                                <div>Telegram –±–æ—Ç: <span id="telegram-status-text">–ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω</span></div>
                                <small class="text-muted" id="telegram-status-desc">–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±–æ—Ç–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</small>
                            </div>
                        </div>
                        
                        <div class="mt-3">
                            <button class="btn btn-outline-secondary w-100 mb-2" onclick="showTelegramSettings()">
                                <i class="fas fa-cog me-2"></i>–ù–∞—Å—Ç—Ä–æ–∏—Ç—å Telegram
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ö–Ω–æ–ø–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ -->
    <button class="admin-btn" onclick="openAdminPanel()" title="–ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞">
        <i class="fas fa-cogs"></i>
        <span class="notification-badge" id="notification-count" style="display: none;">0</span>
    </button>
    
    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∑–∞–∫–∞–∑–µ -->
    <div class="order-notification" id="order-notification" style="display: none;">
        <i class="fas fa-check-circle fa-2x"></i>
        <div>
            <strong>–ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω!</strong>
            <div id="notification-message">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –ø—Ä–æ–¥–∞–≤—Ü—É</div>
        </div>
    </div>
    
    <div class="content-wrapper">
        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
        <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
            <div class="container">
                <a class="navbar-brand" href="#">
                    <i class="fas fa-gamepad me-2"></i>DiverS
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item">
                            <a class="nav-link active" href="#home">–ì–ª–∞–≤–Ω–∞—è</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#products">–¢–æ–≤–∞—Ä—ã</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#cart">–ö–æ—Ä–∑–∏–Ω–∞ <span id="cart-count" class="badge bg-danger cart-badge">0</span></a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏–≥—Ä—ã -->
        <header class="game-header" id="home">
            <div class="container">
                <h1 class="display-4 fw-bold" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">
                    <span style="color: var(--secondary-color);">DiverS</span> Store
                </h1>
                <p class="lead fs-4">–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω –∏–≥—Ä–æ–≤—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –¥–ª—è TimeZero</p>
                <p class="mb-4">–°–Ω–∞—Ä—è–∂–µ–Ω–∏–µ –¥–ª—è –Ω–∞—Å—Ç–æ—è—â–∏—Ö —Å—Ç–∞–ª–∫–µ—Ä–æ–≤ –∏ –Ω–∞–µ–º–Ω–∏–∫–æ–≤</p>
                <a href="#products" class="btn btn-game btn-lg mt-3">
                    <i class="fas fa-shopping-cart me-2"></i>–í –º–∞–≥–∞–∑–∏–Ω
                </a>
            </div>
        </header>

        <!-- –ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤ -->
        <section class="container mt-5" id="products">
            <h2 class="text-center mb-4">–ò–≥—Ä–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã</h2>
            
            <!-- –§–∏–ª—å—Ç—Ä—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º -->
            <div class="category-filter">
                <div class="text-center mb-3">
                    <h5>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å–Ω–∞—Ä—è–∂–µ–Ω–∏—è</h5>
                </div>
                <div class="d-flex flex-wrap justify-content-center">
                    <button class="category-btn active" onclick="filterProducts('all')">–í—Å–µ —Ç–æ–≤–∞—Ä—ã</button>
                    <button class="category-btn" onclick="filterProducts('armor')">–ë—Ä–æ–Ω—è</button>
                    <button class="category-btn" onclick="filterProducts('weapons')">–û—Ä—É–∂–∏–µ</button>
                    <button class="category-btn" onclick="filterProducts('medicine')">–ú–µ–¥–∏—Ü–∏–Ω–∞</button>
                    <button class="category-btn" onclick="filterProducts('attachments')">–í—Å—Ç—Ä–æ–π–∫–∏</button>
                    <button class="category-btn" onclick="filterProducts('ammo')">–ü–∞—Ç—Ä–æ–Ω—ã</button>
                    <button class="category-btn" onclick="filterProducts('throwable')">–ú–µ—Ç–∞—Ç–µ–ª—å–Ω–æ–µ</button>
                </div>
            </div>
            
            <!-- –¢–æ–≤–∞—Ä—ã -->
            <div class="row" id="products-container">
                <!-- –¢–æ–≤–∞—Ä—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                <div class="col-12 text-center">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤...</span>
                    </div>
                    <p class="mt-2">–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤...</p>
                </div>
            </div>
        </section>

        <!-- –ö–æ—Ä–∑–∏–Ω–∞ -->
        <section class="container mt-5" id="cart">
            <h2 class="text-center mb-4">–ö–æ—Ä–∑–∏–Ω–∞ –ø–æ–∫—É–ø–æ–∫</h2>
            <div class="row">
                <div class="col-md-8">
                    <div id="cart-items">
                        <!-- –¢–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω–µ -->
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card" style="background: rgba(30,42,71,0.9); border: 2px solid var(--secondary-color);">
                        <div class="card-body">
                            <h5 class="card-title" style="color: var(--secondary-color);">–°—É–º–º–∞ –∑–∞–∫–∞–∑–∞</h5>
                            <p>–¢–æ–≤–∞—Ä–æ–≤: <span id="total-items">0</span> —à—Ç.</p>
                            <p>–û–±—â–∞—è —Å—É–º–º–∞: <span id="total-price">0.00</span> <i class="fas fa-coins currency-coin"></i></p>
                            <hr style="border-color: var(--secondary-color);">
                            <button class="btn btn-game w-100" onclick="showCheckoutModal()">
                                <i class="fas fa-check me-2"></i>–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑
                            </button>
                            <button class="btn btn-outline-light w-100 mt-2" onclick="clearCart()">
                                <i class="fas fa-trash me-2"></i>–û—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- –§—É—Ç–µ—Ä -->
        <footer class="py-4 mt-5" style="background: rgba(26, 58, 95, 0.9); border-top: 2px solid var(--secondary-color);">
            <div class="container text-center">
                <p>&copy; 2023 DiverS Store. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
                <p class="text-muted">–≠—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –º–∞–≥–∞–∑–∏–Ω–∞ –¥–ª—è –∏–≥—Ä—ã TimeZero</p>
                <div class="mt-3">
                    <a href="#" class="text-secondary mx-2"><i class="fab fa-discord fa-lg"></i></a>
                    <a href="#" class="text-secondary mx-2"><i class="fab fa-telegram fa-lg"></i></a>
                    <a href="#" class="text-secondary mx-2"><i class="fab fa-vk fa-lg"></i></a>
                </div>
            </div>
        </footer>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ -->
        <div class="modal fade" id="checkoutModal" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" style="color: var(--secondary-color);">–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <div class="mb-4">
                            <label for="game-nickname" class="form-label">–ò–≥—Ä–æ–≤–æ–π –Ω–∏–∫–Ω–µ–π–º –≤ TimeZero</label>
                            <input type="text" class="form-control" id="game-nickname" required 
                                   placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –∏–≥—Ä–æ–≤–æ–π –Ω–∏–∫">
                        </div>
                        
                        <div class="mb-4">
                            <p class="mb-2">–°–æ—Å—Ç–∞–≤ –∑–∞–∫–∞–∑–∞:</p>
                            <div class="cart-summary" id="cart-summary" 
                                 style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; max-height: 200px; overflow-y: auto;">
                                <!-- –¢–æ–≤–∞—Ä—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <p>–°—É–º–º–∞ –∫ –æ–ø–ª–∞—Ç–µ: <strong><span id="modal-total-price">0.00</span> <i class="fas fa-coins currency-coin"></i></strong></p>
                            <p class="text-muted small">–ü–æ—Å–ª–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ –ø—Ä–æ–¥–∞–≤—Ü—ã —Å–≤—è–∂—É—Ç—Å—è —Å –≤–∞–º–∏ –≤ –∏–≥—Ä–µ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ —Ç–æ–≤–∞—Ä–∞</p>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                        <button type="button" class="btn btn-game" onclick="processOrder()">
                            <i class="fas fa-check me-1"></i>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–∫–∞–∑
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ -->
        <div class="modal fade" id="addProductModal" tabindex="-1">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="new-product-name" class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</label>
                                <input type="text" class="form-control" id="new-product-name">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="new-product-category" class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                                <select class="form-control" id="new-product-category">
                                    <option value="armor">–ë—Ä–æ–Ω—è</option>
                                    <option value="weapons">–û—Ä—É–∂–∏–µ</option>
                                    <option value="medicine">–ú–µ–¥–∏—Ü–∏–Ω–∞</option>
                                    <option value="attachments">–í—Å—Ç—Ä–æ–π–∫–∏</option>
                                    <option value="ammo">–ü–∞—Ç—Ä–æ–Ω—ã</option>
                                    <option value="throwable">–ú–µ—Ç–∞—Ç–µ–ª—å–Ω–æ–µ</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="new-product-description" class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                            <textarea class="form-control" id="new-product-description" rows="2"></textarea>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="new-product-price" class="form-label">–¶–µ–Ω–∞</label>
                                <div class="price-input-container">
                                    <input type="number" class="form-control" id="new-product-price" 
                                           min="0.01" step="0.01" placeholder="0.00">
                                </div>
                                <small class="form-text text-muted">–¶–µ–Ω–∞ –≤ –º–æ–Ω–µ—Ç–∞—Ö. –ú–æ–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –∫–æ–ø–µ–π–∫–∏ (—Å–æ—Ç—ã–µ –¥–æ–ª–∏)</small>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="new-product-image" class="form-label">–°—Å—ã–ª–∫–∞ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</label>
                                <input type="url" class="form-control" id="new-product-image">
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                        <button type="button" class="btn btn-game" onclick="saveNewProduct()">
                            <i class="fas fa-save me-1"></i>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–≤–∞—Ä
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫ Telegram -->
        <div class="modal fade" id="telegramSettingsModal" tabindex="-1">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">
                            <i class="fab fa-telegram me-2"></i>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram –±–æ—Ç–∞
                        </h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <div class="mb-3">
                            <label for="telegram-bot-token" class="form-label">–¢–æ–∫–µ–Ω –±–æ—Ç–∞</label>
                            <input type="text" class="form-control" id="telegram-bot-token" 
                                   placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: 1234567890:ABCdefGhIjKlMnOprSTUvWxYz)">
                            <small class="form-text text-muted">
                                –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω —É <a href="https://t.me/BotFather" target="_blank" class="text-info">@BotFather</a>
                            </small>
                        </div>
                        
                        <div class="mb-3">
                            <label for="telegram-chat-id" class="form-label">Chat ID –ø—Ä–æ–¥–∞–≤—Ü–∞</label>
                            <input type="text" class="form-control" id="telegram-chat-id" 
                                   placeholder="–í–≤–µ–¥–∏—Ç–µ Chat ID (–Ω–∞–ø—Ä–∏–º–µ—Ä: 123456789)">
                            <small class="form-text text-muted">
                                –ü–æ–ª—É—á–∏—Ç–µ Chat ID —á–µ—Ä–µ–∑ @getmyid_bot
                            </small>
                        </div>
                        
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle me-2"></i>
                            <small>
                                <b>–ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:</b><br>
                                1. –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ @BotFather<br>
                                2. –î–æ–±–∞–≤—å—Ç–µ –±–æ—Ç–∞ –≤ —á–∞—Ç –ø—Ä–æ–¥–∞–≤—Ü–∞<br>
                                3. –ü–æ–ª—É—á–∏—Ç–µ Chat ID —á–µ—Ä–µ–∑ @getmyid_bot
                            </small>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                        <button type="button" class="btn btn-game" onclick="saveTelegramSettings()">
                            <i class="fas fa-save me-1"></i>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // === –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ===
    // –î–µ—Ñ–æ–ª—Ç–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã
    const DEFAULT_PRODUCTS = [
        {
            id: "1",
            name: "–ë—Ä–æ–Ω–µ–∂–∏–ª–µ—Ç '–®—Ç—É—Ä–º–æ–≤–∏–∫'",
            description: "–¢—è–∂–µ–ª—ã–π –±—Ä–æ–Ω–µ–∂–∏–ª–µ—Ç —Å –∑–∞—â–∏—Ç–æ–π 5 –∫–ª–∞—Å—Å–∞",
            price: 1250.50,
            category: "armor",
            image: "https://images.unsplash.com/photo-1588347818030-f6cf3ddf9c6f?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
            features: ["–ó–∞—â–∏—Ç–∞ 5 –∫–ª–∞—Å—Å–∞", "10 —Å–ª–æ—Ç–æ–≤ –¥–ª—è –≤—Å—Ç—Ä–æ–µ–∫", "–£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –ø—É–ª—è–º"]
        },
        {
            id: "2",
            name: "–®–ª–µ–º '–°–Ω–∞–π–ø–µ—Ä'",
            description: "–õ–µ–≥–∫–∏–π —à–ª–µ–º —Å –º–∞—Å–∫–∏—Ä–æ–≤–∫–æ–π –∏ –∑–∞—â–∏—Ç–æ–π –≥–æ–ª–æ–≤—ã",
            price: 850.75,
            category: "armor",
            image: "https://images.unsplash.com/photo-1558618666-fcd25c85cd64?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
            features: ["–ó–∞—â–∏—Ç–∞ 3 –∫–ª–∞—Å—Å–∞", "–ö–∞–º—É—Ñ–ª—è–∂", "–ö—Ä–µ–ø–ª–µ–Ω–∏–µ –¥–ª—è –ü–ù–í"]
        },
        {
            id: "3",
            name: "–ê–ö-47 '–í–æ–ª–∫'",
            description: "–ú–æ–¥–µ—Ä–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç –ö–∞–ª–∞—à–Ω–∏–∫–æ–≤–∞",
            price: 2200.00,
            category: "weapons",
            image: "https://images.unsplash.com/photo-1558618666-fcd25c85cd64?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
            features: ["–ö–∞–ª–∏–±—Ä 7.62–º–º", "–ü—Ä–∏—Ü–µ–ª –ü–°–û-1", "30 –ø–∞—Ç—Ä–æ–Ω–æ–≤ –≤ –º–∞–≥–∞–∑–∏–Ω–µ"]
        },
        {
            id: "4",
            name: "–ê–ø—Ç–µ—á–∫–∞ –ø–µ—Ä–≤–æ–π –ø–æ–º–æ—â–∏",
            description: "–ö–æ–º–ø–ª–µ–∫—Ç –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∑–¥–æ—Ä–æ–≤—å—è",
            price: 450.25,
            category: "medicine",
            image: "https://images.unsplash.com/photo-1559757148-5c350d0d3c56?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
            features: ["+100 –∑–¥–æ—Ä–æ–≤—å—è", "–ë—ã—Å—Ç—Ä–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ", "–ú–Ω–æ–≥–æ—Ä–∞–∑–æ–≤–∞—è"]
        }
    ];
    
    const DEFAULT_SETTINGS = {
        telegram: {
            botToken: "",
            sellers: [],
            notificationTemplate: `üõí <b>–ù–û–í–´–ô –ó–ê–ö–ê–ó #{order_id}</b>

üë§ <b>–ü–æ–∫—É–ø–∞—Ç–µ–ª—å:</b> {nickname}

üì¶ <b>–°–æ—Å—Ç–∞–≤ –∑–∞–∫–∞–∑–∞:</b>
{order_items}

üí∞ <b>–ò—Ç–æ–≥–æ:</b> {total_price} –º–æ–Ω–µ—Ç

üïê <b>–í—Ä–µ–º—è –∑–∞–∫–∞–∑–∞:</b> {order_time}
üìã <b>–°—Ç–∞—Ç—É—Å:</b> ‚è≥ –û–∂–∏–¥–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
<i>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –Ω–∏–∂–µ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞</i>`
        },
        admin: {
            username: "admin",
            password: "admin123"
        }
    };
    
    // === –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ===
    let cart = [];
    let orderHistory = [];
    let adminLoggedIn = false;
    let products = [];
    let settings = { ...DEFAULT_SETTINGS };
    let currentFilter = 'all';
    let excelData = null; // –î–∞–Ω–Ω—ã–µ –∏–∑ Excel —Ñ–∞–π–ª–∞
    
    // === –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï ===
    document.addEventListener('DOMContentLoaded', async function() {
        console.log('Initializing DiverS Store...');
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ—Ä–∑–∏–Ω—É –∏–∑ localStorage
        cart = JSON.parse(localStorage.getItem('divers_cart')) || [];
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
        loadSettings();
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ–≤–∞—Ä—ã
        await loadProducts();
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –∑–∞–∫–∞–∑—ã –∏–∑ localStorage
        orderHistory = JSON.parse(localStorage.getItem('divers_orders')) || [];
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –∞–¥–º–∏–Ω–∞
        adminLoggedIn = localStorage.getItem('admin_logged_in') === 'true';
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        renderCart();
        updateCartCount();
        
        // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è Excel –∑–∞–≥—Ä—É–∑–∫–∏
        setupExcelDragAndDrop();
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
        if (!localStorage.getItem('divers_welcome_shown')) {
            setTimeout(() => {
                showAlert('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –º–∞–≥–∞–∑–∏–Ω DiverS! –í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–≤–∞—Ä—ã –∏ –¥–æ–±–∞–≤—å—Ç–µ –∏—Ö –≤ –∫–æ—Ä–∑–∏–Ω—É.', 'info');
                localStorage.setItem('divers_welcome_shown', 'true');
            }, 1000);
        }
        
        // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        setupEventListeners();
    });
    
    async function loadProducts() {
        try {
            showLoading(true);
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ–≤–∞—Ä—ã –∏–∑ localStorage
            const savedProducts = localStorage.getItem('divers_products');
            
            if (savedProducts) {
                products = JSON.parse(savedProducts);
            } else {
                // –ï—Å–ª–∏ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ
                products = [...DEFAULT_PRODUCTS];
                saveProducts();
            }
            
            // –ï—Å–ª–∏ —Ç–æ–≤–∞—Ä—ã –∑–∞–≥—Ä—É–∑–∏–ª–∏—Å—å, –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º –∏—Ö
            if (products && products.length > 0) {
                renderProducts();
            } else {
                // –ï—Å–ª–∏ –Ω–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                document.getElementById('products-container').innerHTML = `
                    <div class="col-12 text-center py-5">
                        <i class="fas fa-box-open fa-3x mb-3" style="color: var(--secondary-color);"></i>
                        <h4>–¢–æ–≤–∞—Ä—ã –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç</h4>
                        <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ–∑–∂–µ</p>
                        <button class="btn btn-game mt-3" onclick="loadProducts()">
                            <i class="fas fa-sync me-2"></i>–û–±–Ω–æ–≤–∏—Ç—å
                        </button>
                    </div>
                `;
            }
            
        } catch (error) {
            console.error('Failed to load products:', error);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
            document.getElementById('products-container').innerHTML = `
                <div class="col-12 text-center py-5">
                    <i class="fas fa-wifi-slash fa-3x mb-3" style="color: #e74c3c;"></i>
                    <h4>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤</h4>
                    <p>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É</p>
                    <button class="btn btn-game mt-3" onclick="loadProducts()">
                        <i class="fas fa-sync me-2"></i>–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞
                    </button>
                </div>
            `;
        } finally {
            showLoading(false);
        }
    }
    
    function saveProducts() {
        localStorage.setItem('divers_products', JSON.stringify(products));
    }
    
    function loadSettings() {
        const savedSettings = localStorage.getItem('divers_settings');
        if (savedSettings) {
            settings = JSON.parse(savedSettings);
        }
    }
    
    function saveSettings() {
        localStorage.setItem('divers_settings', JSON.stringify(settings));
    }
    
    function showLoading(show) {
        const container = document.getElementById('products-container');
        if (!container) return;
        
        if (show) {
            container.innerHTML = `
                <div class="col-12 text-center py-5">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤...</span>
                    </div>
                    <p class="mt-2">–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤...</p>
                </div>
            `;
        }
    }
    
    // === EXCEL –ò–ú–ü–û–†–¢ –§–£–ù–ö–¶–ò–ò ===
    function setupExcelDragAndDrop() {
        const dropArea = document.getElementById('excel-drop-area');
        const fileInput = document.getElementById('excel-file-input');
        
        if (!dropArea) return;
        
        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, preventDefaults, false);
        });
        
        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }
        
        // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –æ–±–ª–∞—Å—Ç–∏ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
        ['dragenter', 'dragover'].forEach(eventName => {
            dropArea.addEventListener(eventName, highlight, false);
        });
        
        ['dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, unhighlight, false);
        });
        
        function highlight() {
            dropArea.classList.add('dragover');
        }
        
        function unhighlight() {
            dropArea.classList.remove('dragover');
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–±—Ä–æ—Å–∞ —Ñ–∞–π–ª–æ–≤
        dropArea.addEventListener('drop', handleDrop, false);
        
        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            
            if (files.length > 0) {
                handleExcelFiles(files[0]);
            }
        }
    }
    
    function handleExcelFileSelect(event) {
        const files = event.target.files;
        if (files.length > 0) {
            handleExcelFiles(files[0]);
        }
    }
    
    function handleExcelFiles(file) {
        const validExtensions = ['.xlsx', '.xls', '.csv'];
        const fileExtension = file.name.substring(file.name.lastIndexOf('.')).toLowerCase();
        
        if (!validExtensions.includes(fileExtension)) {
            showAlert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª Excel (.xlsx, .xls) –∏–ª–∏ CSV', 'danger');
            return;
        }
        
        const reader = new FileReader();
        
        reader.onload = function(e) {
            try {
                const data = e.target.result;
                const workbook = XLSX.read(data, { type: 'binary' });
                
                // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø–µ—Ä–≤–æ–≥–æ –ª–∏—Å—Ç–∞
                const firstSheetName = workbook.SheetNames[0];
                const worksheet = workbook.Sheets[firstSheetName];
                
                // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ JSON
                const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                
                if (jsonData.length === 0) {
                    showAlert('–§–∞–π–ª –ø—É—Å—Ç –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ', 'warning');
                    return;
                }
                
                // –ò–∑–≤–ª–µ–∫–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞)
                const headers = jsonData[0];
                
                // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤
                const dataRows = jsonData.slice(1);
                const processedData = dataRows.map(row => {
                    const obj = {};
                    headers.forEach((header, index) => {
                        if (header && row[index] !== undefined) {
                            // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –∫–ª—é—á–∏ –≤ –Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä –∏ —É–±–∏—Ä–∞–µ–º –ø—Ä–æ–±–µ–ª—ã
                            const key = header.toString().toLowerCase().replace(/\s+/g, '_');
                            obj[key] = row[index];
                        }
                    });
                    return obj;
                }).filter(obj => Object.keys(obj).length > 0); // –£–±–∏—Ä–∞–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏
                
                excelData = processedData;
                showExcelPreview(excelData);
                
            } catch (error) {
                console.error('Error reading Excel file:', error);
                showAlert('–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞.', 'danger');
            }
        };
        
        reader.onerror = function() {
            showAlert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞', 'danger');
        };
        
        reader.readAsBinaryString(file);
    }
    
    function showExcelPreview(data) {
        const previewContainer = document.getElementById('excel-preview-container');
        const previewTable = document.getElementById('excel-preview-table');
        const importStats = document.getElementById('import-stats');
        
        if (!previewContainer || !previewTable) return;
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞
        previewContainer.style.display = 'block';
        
        // –°–∫—Ä—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∏–º–ø–æ—Ä—Ç–∞
        if (importStats) {
            importStats.style.display = 'none';
        }
        
        // –û—á–∏—â–∞–µ–º —Ç–∞–±–ª–∏—Ü—É
        previewTable.innerHTML = '';
        
        if (data.length === 0) {
            previewTable.innerHTML = '<tr><td colspan="10" class="text-center">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</td></tr>';
            return;
        }
        
        // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏ (–∑–∞–≥–æ–ª–æ–≤–∫–∏ —Å—Ç–æ–ª–±—Ü–æ–≤)
        const allKeys = new Set();
        data.forEach(row => {
            Object.keys(row).forEach(key => allKeys.add(key));
        });
        
        const headers = Array.from(allKeys);
        
        // –°–æ–∑–¥–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã
        let tableHTML = '<thead><tr>';
        headers.forEach(header => {
            tableHTML += `<th>${formatHeader(header)}</th>`;
        });
        tableHTML += '</tr></thead><tbody>';
        
        // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö (–ø–µ—Ä–≤—ã–µ 10 —Å—Ç—Ä–æ–∫ –¥–ª—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞)
        const previewRows = data.slice(0, 10);
        previewRows.forEach(row => {
            tableHTML += '<tr>';
            headers.forEach(header => {
                const value = row[header] !== undefined ? row[header] : '';
                tableHTML += `<td title="${header}">${truncateText(value.toString(), 30)}</td>`;
            });
            tableHTML += '</tr>';
        });
        
        tableHTML += '</tbody>';
        
        if (data.length > 10) {
            tableHTML += `<tfoot><tr><td colspan="${headers.length}" class="text-center">
                <small>–∏ –µ—â–µ ${data.length - 10} —Å—Ç—Ä–æ–∫...</small>
            </td></tr></tfoot>`;
        }
        
        previewTable.innerHTML = tableHTML;
    }
    
    function formatHeader(header) {
        // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è –ª—É—á—à–µ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
        const headerMap = {
            'id': 'ID',
            'name': '–ù–∞–∑–≤–∞–Ω–∏–µ',
            'description': '–û–ø–∏—Å–∞–Ω–∏–µ',
            'price': '–¶–µ–Ω–∞',
            'category': '–ö–∞—Ç–µ–≥–æ—Ä–∏—è',
            'image': '–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ',
            'features': '–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏',
            '–∫–æ–¥': 'ID',
            '–Ω–∞–∑–≤–∞–Ω–∏–µ': '–ù–∞–∑–≤–∞–Ω–∏–µ',
            '–æ–ø–∏—Å–∞–Ω–∏–µ': '–û–ø–∏—Å–∞–Ω–∏–µ',
            '—Ü–µ–Ω–∞': '–¶–µ–Ω–∞',
            '–∫–∞—Ç–µ–≥–æ—Ä–∏—è': '–ö–∞—Ç–µ–≥–æ—Ä–∏—è',
            '–∫–∞—Ä—Ç–∏–Ω–∫–∞': '–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ',
            '—Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏': '–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏'
        };
        
        return headerMap[header.toLowerCase()] || header;
    }
    
    function truncateText(text, maxLength) {
        if (text.length <= maxLength) return text;
        return text.substring(0, maxLength) + '...';
    }
    
    function importExcelData() {
        if (!excelData || excelData.length === 0) {
            showAlert('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞', 'warning');
            return;
        }
        
        try {
            // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ Excel –≤ —Ñ–æ—Ä–º–∞—Ç –º–∞–≥–∞–∑–∏–Ω–∞
            const importedProducts = [];
            let importedCount = 0;
            let skippedCount = 0;
            
            excelData.forEach((row, index) => {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
                if (!row.name || !row.price) {
                    console.warn(`–°—Ç—Ä–æ–∫–∞ ${index + 2}: –ø—Ä–æ–ø—É—â–µ–Ω–∞ - –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è`);
                    skippedCount++;
                    return;
                }
                
                // –°–æ–∑–¥–∞–µ–º ID –µ—Å–ª–∏ –Ω–µ—Ç
                const id = row.id || `excel_${Date.now()}_${index}`;
                
                // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ (—Å—Ç—Ä–æ–∫–∞ –∏–ª–∏ –º–∞—Å—Å–∏–≤)
                let features = [];
                if (row.features) {
                    if (typeof row.features === 'string') {
                        features = row.features.split(';').map(f => f.trim()).filter(f => f);
                    } else if (Array.isArray(row.features)) {
                        features = row.features;
                    }
                }
                
                // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é
                let category = 'armor';
                if (row.category) {
                    const categoryStr = row.category.toString().toLowerCase();
                    const categoryMap = {
                        '–±—Ä–æ–Ω—è': 'armor',
                        '–æ—Ä—É–∂–∏–µ': 'weapons',
                        '–º–µ–¥–∏—Ü–∏–Ω–∞': 'medicine',
                        '–≤—Å—Ç—Ä–æ–π–∫–∏': 'attachments',
                        '–ø–∞—Ç—Ä–æ–Ω—ã': 'ammo',
                        '–º–µ—Ç–∞—Ç–µ–ª—å–Ω–æ–µ': 'throwable',
                        'armor': 'armor',
                        'weapons': 'weapons',
                        'medicine': 'medicine',
                        'attachments': 'attachments',
                        'ammo': 'ammo',
                        'throwable': 'throwable'
                    };
                    category = categoryMap[categoryStr] || 'armor';
                }
                
                // –°–æ–∑–¥–∞–µ–º –ø—Ä–æ–¥—É–∫—Ç
                const product = {
                    id: id,
                    name: row.name.toString(),
                    description: row.description ? row.description.toString() : '',
                    price: parseFloat(row.price) || 0,
                    category: category,
                    image: row.image ? row.image.toString() : 'https://via.placeholder.com/300x200?text=DiverS+Store',
                    features: features
                };
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–æ –∏–º–µ–Ω–∏
                const isDuplicate = importedProducts.some(p => p.name === product.name) ||
                                  products.some(p => p.name === product.name);
                
                if (!isDuplicate) {
                    importedProducts.push(product);
                    importedCount++;
                } else {
                    skippedCount++;
                }
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º
            products = [...products, ...importedProducts];
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–≤–∞—Ä—ã
            saveProducts();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            renderProducts();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            showImportStats(importedCount, skippedCount);
            
            // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä
            clearExcelPreview();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
            if (adminLoggedIn) {
                loadAdminProducts();
            }
            
            showAlert(`–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ ${importedCount} —Ç–æ–≤–∞—Ä–æ–≤`, 'success');
            
        } catch (error) {
            console.error('Import error:', error);
            showAlert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –¥–∞–Ω–Ω—ã—Ö: ' + error.message, 'danger');
        }
    }
    
    function showImportStats(imported, skipped) {
        const importStats = document.getElementById('import-stats');
        const importMessage = document.getElementById('import-message');
        
        if (!importStats || !importMessage) return;
        
        let message = `–ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω!<br>`;
        message += `‚Ä¢ –£—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ: <strong>${imported}</strong> —Ç–æ–≤–∞—Ä–æ–≤<br>`;
        
        if (skipped > 0) {
            message += `‚Ä¢ –ü—Ä–æ–ø—É—â–µ–Ω–æ: <strong>${skipped}</strong> —Ç–æ–≤–∞—Ä–æ–≤ (–¥—É–±–ª–∏–∫–∞—Ç—ã –∏–ª–∏ –æ—à–∏–±–∫–∏)`;
        }
        
        importMessage.innerHTML = message;
        importStats.style.display = 'block';
    }
    
    function clearExcelPreview() {
        const previewContainer = document.getElementById('excel-preview-container');
        const previewTable = document.getElementById('excel-preview-table');
        const fileInput = document.getElementById('excel-file-input');
        
        if (previewContainer) previewContainer.style.display = 'none';
        if (previewTable) previewTable.innerHTML = '';
        if (fileInput) fileInput.value = '';
        
        excelData = null;
    }
    
    function downloadExcelTemplate() {
        // –°–æ–∑–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —à–∞–±–ª–æ–Ω–∞
        const templateData = [
            ['id', 'name', 'description', 'price', 'category', 'image', 'features'],
            ['1', '–ë—Ä–æ–Ω–µ–∂–∏–ª–µ—Ç "–®—Ç—É—Ä–º–æ–≤–∏–∫"', '–¢—è–∂–µ–ª—ã–π –±—Ä–æ–Ω–µ–∂–∏–ª–µ—Ç —Å –∑–∞—â–∏—Ç–æ–π 5 –∫–ª–∞—Å—Å–∞', '1250.50', 'armor', 'https://example.com/image1.jpg', '–ó–∞—â–∏—Ç–∞ 5 –∫–ª–∞—Å—Å–∞;10 —Å–ª–æ—Ç–æ–≤;–£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –ø—É–ª—è–º'],
            ['2', '–ê–ö-47 "–í–æ–ª–∫"', '–ú–æ–¥–µ—Ä–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç –ö–∞–ª–∞—à–Ω–∏–∫–æ–≤–∞', '2200.00', 'weapons', 'https://example.com/image2.jpg', '–ö–∞–ª–∏–±—Ä 7.62–º–º;–ü—Ä–∏—Ü–µ–ª –ü–°–û-1;30 –ø–∞—Ç—Ä–æ–Ω–æ–≤'],
            ['3', '–ê–ø—Ç–µ—á–∫–∞ –ø–µ—Ä–≤–æ–π –ø–æ–º–æ—â–∏', '–ö–æ–º–ø–ª–µ–∫—Ç –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∑–¥–æ—Ä–æ–≤—å—è', '450.25', 'medicine', 'https://example.com/image3.jpg', '+100 –∑–¥–æ—Ä–æ–≤—å—è;–ë—ã—Å—Ç—Ä–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ;–ú–Ω–æ–≥–æ—Ä–∞–∑–æ–≤–∞—è']
        ];
        
        // –°–æ–∑–¥–∞–µ–º —Ä–∞–±–æ—á—É—é –∫–Ω–∏–≥—É
        const wb = XLSX.utils.book_new();
        const ws = XLSX.utils.aoa_to_sheet(templateData);
        
        // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ (—à–∏—Ä–∏–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫)
        const wscols = [
            {wch: 5},  // id
            {wch: 25}, // name
            {wch: 40}, // description
            {wch: 10}, // price
            {wch: 15}, // category
            {wch: 30}, // image
            {wch: 40}  // features
        ];
        ws['!cols'] = wscols;
        
        XLSX.utils.book_append_sheet(wb, ws, "–¢–æ–≤–∞—Ä—ã");
        
        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∏ —Å–∫–∞—á–∏–≤–∞–µ–º —Ñ–∞–π–ª
        XLSX.writeFile(wb, "divers_store_template.xlsx");
        
        showAlert('–®–∞–±–ª–æ–Ω Excel —Å–∫–∞—á–∞–Ω! –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –µ–≥–æ —Å–≤–æ–∏–º–∏ —Ç–æ–≤–∞—Ä–∞–º–∏.', 'info');
    }
    
    // === –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï –¢–û–í–ê–†–û–í ===
    function renderProducts() {
        const container = document.getElementById('products-container');
        if (!container) return;
        
        const filteredProducts = currentFilter === 'all' 
            ? products 
            : products.filter(p => p.category === currentFilter);
        
        if (filteredProducts.length === 0) {
            container.innerHTML = `
                <div class="col-12 text-center py-5">
                    <i class="fas fa-search fa-3x mb-3" style="color: var(--secondary-color);"></i>
                    <h4>–¢–æ–≤–∞—Ä—ã –≤ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç</h4>
                    <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é</p>
                </div>
            `;
            return;
        }
        
        let html = '';
        
        filteredProducts.forEach(product => {
            html += `
                <div class="col-md-4 col-lg-3 mb-4">
                    <div class="product-card h-100">
                        <div style="position: relative;">
                            <img src="${product.image || 'https://via.placeholder.com/300x200?text=DiverS+Store'}" 
                                 class="product-img" alt="${product.name}"
                                 onerror="this.src='https://via.placeholder.com/300x200?text=DiverS+Store'">
                            <span class="category-badge" style="background: ${getCategoryColor(product.category)}">
                                ${getCategoryName(product.category)}
                            </span>
                        </div>
                        <div class="p-3">
                            <h5 class="mb-2">${product.name}</h5>
                            <p class="text-muted small mb-3" style="min-height: 60px;">${product.description}</p>
                            
                            ${product.features && product.features.length > 0 ? `
                                <div class="mb-3">
                                    ${product.features.map(f => 
                                        `<span class="badge bg-secondary me-1 mb-1">${f}</span>`
                                    ).join('')}
                                </div>
                            ` : ''}
                            
                            <div class="d-flex justify-content-between align-items-center mt-auto">
                                <span class="price-tag">${formatPrice(product.price)} <i class="fas fa-coins currency-coin"></i></span>
                                <button class="btn btn-game btn-sm" onclick="addToCart('${product.id}')">
                                    <i class="fas fa-cart-plus me-1"></i>–í –∫–æ—Ä–∑–∏–Ω—É
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        });
        
        container.innerHTML = html;
    }
    
    function filterProducts(category) {
        currentFilter = category;
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
        document.querySelectorAll('.category-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        event.target.classList.add('active');
        
        renderProducts();
    }
    
    // === –§–£–ù–ö–¶–ò–ò –ö–û–†–ó–ò–ù–´ ===
    function addToCart(productId, quantity = 1) {
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–µ—Å—Ç—Ä–æ–≥–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ == –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ç–æ–≤–∞—Ä–∞
        const product = products.find(p => p.id == productId);
        
        if (!product) {
            showAlert('–¢–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω! ID: ' + productId, 'danger');
            return;
        }
        
        const existingItem = cart.find(item => item.id == productId);
        
        if (existingItem) {
            existingItem.quantity += quantity;
        } else {
            cart.push({
                id: product.id.toString(), // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–∞–∫ —Å—Ç—Ä–æ–∫—É
                name: product.name,
                price: parseFloat(product.price),
                quantity: quantity,
                category: product.category,
                image: product.image
            });
        }
        
        saveCart();
        renderCart();
        updateCartCount();
        
        showAlert(`"${product.name}" –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É!`, 'success');
    }
    
    function removeFromCart(productId) {
        const itemIndex = cart.findIndex(item => item.id == productId);
        
        if (itemIndex > -1) {
            const removedItem = cart[itemIndex];
            cart.splice(itemIndex, 1);
            saveCart();
            renderCart();
            updateCartCount();
            showAlert(`"${removedItem.name}" —É–¥–∞–ª–µ–Ω –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã`, 'info');
        }
    }
    
    function updateQuantity(productId, newQuantity) {
        if (newQuantity < 1) {
            removeFromCart(productId);
            return;
        }
        
        const item = cart.find(item => item.id == productId);
        if (item) {
            item.quantity = newQuantity;
            saveCart();
            renderCart();
        }
    }
    
    function clearCart() {
        if (cart.length === 0) {
            showAlert('–ö–æ—Ä–∑–∏–Ω–∞ —É–∂–µ –ø—É—Å—Ç–∞!', 'info');
            return;
        }
        
        if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É?')) {
            cart = [];
            saveCart();
            renderCart();
            updateCartCount();
            showAlert('–ö–æ—Ä–∑–∏–Ω–∞ –æ—á–∏—â–µ–Ω–∞!', 'success');
        }
    }
    
    function saveCart() {
        localStorage.setItem('divers_cart', JSON.stringify(cart));
    }
    
    function renderCart() {
        const container = document.getElementById('cart-items');
        const cartCount = document.getElementById('cart-count');
        const totalItems = document.getElementById('total-items');
        const totalPrice = document.getElementById('total-price');
        
        if (!container) return;
        
        if (cart.length === 0) {
            container.innerHTML = `
                <div class="empty-cart">
                    <i class="fas fa-shopping-cart empty-cart-icon"></i>
                    <h4>–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</h4>
                    <p>–î–æ–±–∞–≤—å—Ç–µ —Ç–æ–≤–∞—Ä—ã –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞</p>
                    <a href="#products" class="btn btn-game" onclick="filterProducts('all')">–ü–µ—Ä–µ–π—Ç–∏ –∫ —Ç–æ–≤–∞—Ä–∞–º</a>
                </div>
            `;
            
            if (cartCount) cartCount.textContent = '0';
            if (totalItems) totalItems.textContent = '0';
            if (totalPrice) totalPrice.textContent = '0.00';
            return;
        }
        
        let itemsCount = 0;
        let priceTotal = 0;
        let cartHTML = '';
        
        cart.forEach((item, index) => {
            itemsCount += item.quantity;
            priceTotal += parseFloat(item.price) * item.quantity;
            
            cartHTML += `
                <div class="cart-item">
                    <div class="d-flex justify-content-between align-items-center">
                        <div style="flex-grow: 1;">
                            <h6 class="mb-1">${item.name}</h6>
                            <div class="d-flex align-items-center">
                                <span class="badge bg-secondary me-2">${getCategoryName(item.category)}</span>
                                <span class="text-muted">${formatPrice(item.price)} √ó ${item.quantity}</span>
                            </div>
                        </div>
                        <div class="text-end">
                            <div class="mb-2">${formatPrice(parseFloat(item.price) * item.quantity)} <i class="fas fa-coins currency-coin"></i></div>
                            <div>
                                <button class="btn btn-sm btn-outline-secondary me-1" onclick="updateQuantity('${item.id}', ${item.quantity - 1})" ${item.quantity <= 1 ? 'disabled' : ''}>
                                    <i class="fas fa-minus"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-secondary" onclick="updateQuantity('${item.id}', ${item.quantity + 1})">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-danger ms-2" onclick="removeFromCart('${item.id}')">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        });
        
        container.innerHTML = cartHTML;
        
        if (cartCount) cartCount.textContent = itemsCount;
        if (totalItems) totalItems.textContent = itemsCount;
        if (totalPrice) totalPrice.textContent = formatPrice(priceTotal);
    }
    
    function updateCartCount() {
        const count = cart.reduce((sum, item) => sum + item.quantity, 0);
        const cartCountElement = document.getElementById('cart-count');
        if (cartCountElement) {
            cartCountElement.textContent = count;
        }
    }
    
    // === –û–§–û–†–ú–õ–ï–ù–ò–ï –ó–ê–ö–ê–ó–ê ===
    function showCheckoutModal() {
        if (cart.length === 0) {
            showAlert('–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞!', 'warning');
            return;
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—É–º–º—É –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
        const total = cart.reduce((sum, item) => sum + (parseFloat(item.price) * item.quantity), 0);
        document.getElementById('modal-total-price').textContent = formatPrice(total);
        
        // –ó–∞–ø–æ–ª–Ω—è–µ–º —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤
        const cartSummary = document.getElementById('cart-summary');
        cartSummary.innerHTML = '';
        
        cart.forEach(item => {
            const itemElement = document.createElement('div');
            itemElement.className = 'd-flex justify-content-between align-items-center mb-2';
            itemElement.innerHTML = `
                <div>
                    <small>${item.name}</small><br>
                    <small class="text-muted">${item.quantity} √ó ${formatPrice(item.price)} –º–æ–Ω–µ—Ç</small>
                </div>
                <div>
                    <small>${formatPrice(parseFloat(item.price) * item.quantity)} –º–æ–Ω–µ—Ç</small>
                </div>
            `;
            cartSummary.appendChild(itemElement);
        });
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
        const modal = new bootstrap.Modal(document.getElementById('checkoutModal'));
        modal.show();
    }
    
    async function processOrder() {
        const nicknameInput = document.getElementById('game-nickname');
        const nickname = nicknameInput.value.trim();
        
        if (!nickname) {
            showAlert('–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –∏–≥—Ä–æ–≤–æ–π –Ω–∏–∫–Ω–µ–π–º!', 'danger');
            nicknameInput.focus();
            return;
        }
        
        if (nickname.length < 3) {
            showAlert('–ù–∏–∫–Ω–µ–π–º –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞!', 'danger');
            nicknameInput.focus();
            return;
        }
        
        // –°–æ–∑–¥–∞–µ–º –∑–∞–∫–∞–∑
        const orderId = 'ORD' + Date.now().toString().substr(-8);
        const orderTime = new Date().toLocaleString('ru-RU');
        const totalPrice = cart.reduce((sum, item) => sum + (parseFloat(item.price) * item.quantity), 0);
        
        const order = {
            id: orderId,
            nickname: nickname,
            items: cart.map(item => ({
                name: item.name,
                quantity: item.quantity,
                price: parseFloat(item.price),
                total: parseFloat((parseFloat(item.price) * item.quantity).toFixed(2))
            })),
            totalPrice: parseFloat(totalPrice.toFixed(2)),
            time: orderTime,
            status: 'pending',
            createdAt: new Date().toISOString()
        };
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–∞–∫–∞–∑ –ª–æ–∫–∞–ª—å–Ω–æ
        orderHistory.push(order);
        localStorage.setItem('divers_orders', JSON.stringify(orderHistory));
        
        // –û—á–∏—â–∞–µ–º –∫–æ—Ä–∑–∏–Ω—É
        cart = [];
        saveCart();
        renderCart();
        updateCartCount();
        
        // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
        const modal = bootstrap.Modal.getInstance(document.getElementById('checkoutModal'));
        modal.hide();
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        showOrderNotification(
            true, 
            '–ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω! –ü—Ä–æ–¥–∞–≤–µ—Ü —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏ –≤ –∏–≥—Ä–µ.'
        );
        
        showAlert(`–ó–∞–∫–∞–∑ #${orderId} —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω!`, 'success');
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–∞
        if (adminLoggedIn) {
            loadAdminOrders();
        }
    }
    
    // === –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨ ===
    function openAdminPanel() {
        document.getElementById('admin-panel').classList.add('active');
        document.getElementById('admin-overlay').classList.add('active');
        
        if (adminLoggedIn) {
            showAdminTab('products');
        }
    }
    
    function closeAdminPanel() {
        document.getElementById('admin-panel').classList.remove('active');
        document.getElementById('admin-overlay').classList.remove('active');
    }
    
    function adminLogin() {
        const username = document.getElementById('admin-username').value;
        const password = document.getElementById('admin-password').value;
        
        if (username === settings.admin.username && password === settings.admin.password) {
            adminLoggedIn = true;
            localStorage.setItem('admin_logged_in', 'true');
            
            document.getElementById('admin-auth-section').style.display = 'none';
            document.getElementById('admin-controls').style.display = 'block';
            
            showAdminTab('products');
            loadAdminData();
            
            showAlert('–£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥ –≤ –ø–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞!', 'success');
        } else {
            showAlert('–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å!', 'danger');
        }
    }
    
    function adminLogout() {
        adminLoggedIn = false;
        localStorage.removeItem('admin_logged_in');
        
        document.getElementById('admin-auth-section').style.display = 'block';
        document.getElementById('admin-controls').style.display = 'none';
        
        // –û—á–∏—â–∞–µ–º –ø–æ–ª—è
        document.getElementById('admin-username').value = '';
        document.getElementById('admin-password').value = '';
        
        showAlert('–í—ã –≤—ã—à–ª–∏ –∏–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏', 'info');
    }
    
    function showAdminTab(tabName) {
        // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
        document.querySelectorAll('.admin-tab-content').forEach(tab => {
            tab.style.display = 'none';
        });
        
        // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
        document.querySelectorAll('#adminTabs .nav-link').forEach(btn => {
            btn.classList.remove('active');
        });
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é –≤–∫–ª–∞–¥–∫—É
        document.getElementById(`admin-${tabName}-tab`).style.display = 'block';
        
        // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ –∫–Ω–æ–ø–∫–µ
        event.target.classList.add('active');
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤–∫–ª–∞–¥–∫–∏
        if (tabName === 'products') {
            loadAdminProducts();
        } else if (tabName === 'orders') {
            loadAdminOrders();
        } else if (tabName === 'telegram') {
            loadTelegramStatus();
        }
    }
    
    function loadAdminData() {
        loadAdminProducts();
        loadAdminOrders();
        loadTelegramStatus();
    }
    
    function loadAdminProducts() {
        const container = document.getElementById('quick-products-list');
        if (!container) return;
        
        if (products.length === 0) {
            container.innerHTML = '<div class="text-center text-muted p-2">–ù–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤</div>';
            return;
        }
        
        let html = '';
        
        products.slice(0, 10).forEach(product => {
            html += `
                <div class="list-group-item" style="background: rgba(255,255,255,0.1); color: white; border-color: rgba(0,168,255,0.2);">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <small>${product.name}</small><br>
                            <small class="text-muted">${formatPrice(product.price)} <i class="fas fa-coins"></i></small>
                        </div>
                        <div>
                            <button class="btn btn-sm btn-outline-danger" onclick="deleteProduct('${product.id}')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `;
        });
        
        container.innerHTML = html;
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        const categories = new Set(products.map(p => p.category));
        document.getElementById('admin-total-products').textContent = products.length;
        document.getElementById('admin-total-categories').textContent = categories.size;
    }
    
    function loadAdminOrders() {
        const container = document.getElementById('orders-list-container');
        if (!container) return;
        
        const pendingOrders = orderHistory.filter(o => o.status === 'pending');
        
        if (pendingOrders.length === 0) {
            container.innerHTML = `
                <div class="text-center text-muted py-4">
                    <i class="fas fa-check-circle fa-3x mb-3 opacity-50"></i>
                    <p>–ù–µ—Ç –æ–∂–∏–¥–∞—é—â–∏—Ö –∑–∞–∫–∞–∑–æ–≤</p>
                </div>
            `;
            return;
        }
        
        let html = '';
        
        pendingOrders.forEach(order => {
            const orderItems = order.items.map(item => 
                `<div class="d-flex justify-content-between">
                    <span>${item.name} √ó ${item.quantity}</span>
                    <span>${formatPrice(item.total)} –º–æ–Ω–µ—Ç</span>
                </div>`
            ).join('');
            
            html += `
                <div class="order-card">
                    <div class="d-flex justify-content-between align-items-start mb-2">
                        <div>
                            <h6 class="mb-1">–ó–∞–∫–∞–∑ #${order.id}</h6>
                            <small class="text-muted">${order.time}</small>
                        </div>
                        <span class="status-badge status-pending">‚è≥ –û–∂–∏–¥–∞–µ—Ç</span>
                    </div>
                    
                    <div class="mb-2">
                        <strong><i class="fas fa-user me-1"></i>${order.nickname}</strong>
                    </div>
                    
                    <div class="mb-2">
                        <small class="text-muted">–¢–æ–≤–∞—Ä—ã:</small>
                        <div class="mt-1">
                            ${orderItems}
                        </div>
                    </div>
                    
                    <div class="d-flex justify-content-between align-items-center mt-3">
                        <div>
                            <strong>–ò—Ç–æ–≥–æ: ${formatPrice(order.totalPrice)} <i class="fas fa-coins currency-coin"></i></strong>
                        </div>
                        <div class="order-actions">
                            <button class="btn btn-sm btn-success" onclick="completeOrder('${order.id}')">
                                <i class="fas fa-check"></i> –í—ã–¥–∞–Ω
                            </button>
                        </div>
                    </div>
                </div>
            `;
        });
        
        container.innerHTML = html;
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –∑–∞–∫–∞–∑–æ–≤
        const badge = document.getElementById('orders-count-badge');
        badge.textContent = pendingOrders.length;
        badge.style.display = pendingOrders.length > 0 ? 'inline' : 'none';
    }
    
    function loadTelegramStatus() {
        const statusElement = document.getElementById('telegram-status');
        const statusText = document.getElementById('telegram-status-text');
        const statusDesc = document.getElementById('telegram-status-desc');
        
        if (settings.telegram.botToken) {
            statusElement.className = 'telegram-status connected';
            statusText.textContent = '–ù–∞—Å—Ç—Ä–æ–µ–Ω';
            statusDesc.textContent = '–ë–æ—Ç –≥–æ—Ç–æ–≤ –∫ –æ—Ç–ø—Ä–∞–≤–∫–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π';
        } else {
            statusElement.className = 'telegram-status disconnected';
            statusText.textContent = '–ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω';
            statusDesc.textContent = '–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±–æ—Ç–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π';
        }
    }
    
    function showAddProductModal() {
        // –û—á–∏—â–∞–µ–º –ø–æ–ª—è
        document.getElementById('new-product-name').value = '';
        document.getElementById('new-product-description').value = '';
        document.getElementById('new-product-price').value = '';
        document.getElementById('new-product-image').value = '';
        document.getElementById('new-product-category').value = 'armor';
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
        const modal = new bootstrap.Modal(document.getElementById('addProductModal'));
        modal.show();
    }
    
    async function saveNewProduct() {
        const name = document.getElementById('new-product-name').value.trim();
        const description = document.getElementById('new-product-description').value.trim();
        const price = parseFloat(document.getElementById('new-product-price').value);
        const image = document.getElementById('new-product-image').value.trim();
        const category = document.getElementById('new-product-category').value;
        
        if (!name || !description || isNaN(price) || price <= 0 || !image) {
            showAlert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!', 'danger');
            return;
        }
        
        // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä
        const newProduct = {
            id: 'prod_' + Date.now(),
            name: name,
            description: description,
            price: price,
            category: category,
            image: image,
            features: []
        };
        
        // –î–æ–±–∞–≤–ª—è–µ–º —Ç–æ–≤–∞—Ä
        products.push(newProduct);
        saveProducts();
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        renderProducts();
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
        loadAdminProducts();
        
        // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
        const modal = bootstrap.Modal.getInstance(document.getElementById('addProductModal'));
        modal.hide();
        
        showAlert('–¢–æ–≤–∞—Ä —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!', 'success');
    }
    
    async function deleteProduct(productId) {
        if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä?')) return;
        
        // –£–¥–∞–ª—è–µ–º —Ç–æ–≤–∞—Ä
        products = products.filter(p => p.id == productId);
        saveProducts();
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        renderProducts();
        loadAdminProducts();
        
        showAlert('–¢–æ–≤–∞—Ä —É–¥–∞–ª–µ–Ω!', 'warning');
    }
    
    function completeOrder(orderId) {
        const orderIndex = orderHistory.findIndex(o => o.id === orderId);
        
        if (orderIndex !== -1) {
            orderHistory[orderIndex].status = 'completed';
            localStorage.setItem('divers_orders', JSON.stringify(orderHistory));
            loadAdminOrders();
            showAlert(`–ó–∞–∫–∞–∑ #${orderId} –æ—Ç–º–µ—á–µ–Ω –∫–∞–∫ –≤—ã–¥–∞–Ω–Ω—ã–π`, 'success');
        }
    }
    
    function showTelegramSettings() {
        // –ó–∞–ø–æ–ª–Ω—è–µ–º –ø–æ–ª—è —Ç–µ–∫—É—â–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
        document.getElementById('telegram-bot-token').value = settings.telegram.botToken || '';
        document.getElementById('telegram-chat-id').value = 
            settings.telegram.sellers && settings.telegram.sellers.length > 0 
            ? settings.telegram.sellers[0].chatId 
            : '';
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
        const modal = new bootstrap.Modal(document.getElementById('telegramSettingsModal'));
        modal.show();
    }
    
    async function saveTelegramSettings() {
        const botToken = document.getElementById('telegram-bot-token').value.trim();
        const chatId = document.getElementById('telegram-chat-id').value.trim();
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
        settings.telegram.botToken = botToken;
        settings.telegram.sellers = chatId ? [{ 
            name: '–û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–¥–∞–≤–µ—Ü', 
            chatId: chatId, 
            role: 'admin',
            notificationsEnabled: true 
        }] : [];
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ª–æ–∫–∞–ª—å–Ω–æ
        saveSettings();
        
        // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
        const modal = bootstrap.Modal.getInstance(document.getElementById('telegramSettingsModal'));
        modal.hide();
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
        loadTelegramStatus();
        
        showAlert('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!', 'success');
    }
    
    // === –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ===
    function setupEventListeners() {
        // –û–≤–µ—Ä–ª–µ–π –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
        const adminOverlay = document.getElementById('admin-overlay');
        if (adminOverlay) {
            adminOverlay.addEventListener('click', closeAdminPanel);
        }
        
        // –ü–ª–∞–≤–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                if (targetId === '#') return;
                    
                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                    window.scrollTo({
                        top: targetElement.offsetTop - 80,
                        behavior: 'smooth'
                    });
                }
            });
        });
        
        // –ö–ª–∞–≤–∏—à–∏ –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
        document.addEventListener('keydown', function(e) {
            // Ctrl+Alt+A –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
            if (e.ctrlKey && e.altKey && e.key === 'a') {
                e.preventDefault();
                openAdminPanel();
            }
            
            // Escape –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
            if (e.key === 'Escape') {
                closeAdminPanel();
            }
        });
    }
    
    function formatPrice(price) {
        return parseFloat(price).toFixed(2);
    }
    
    function getCategoryName(category) {
        const names = {
            'armor': '–ë—Ä–æ–Ω—è',
            'weapons': '–û—Ä—É–∂–∏–µ',
            'medicine': '–ú–µ–¥–∏—Ü–∏–Ω–∞',
            'attachments': '–í—Å—Ç—Ä–æ–π–∫–∏',
            'ammo': '–ü–∞—Ç—Ä–æ–Ω—ã',
            'throwable': '–ú–µ—Ç–∞—Ç–µ–ª—å–Ω–æ–µ'
        };
        return names[category] || category;
    }
    
    function getCategoryColor(category) {
        const colors = {
            'armor': '#3498db',
            'weapons': '#e74c3c',
            'medicine': '#2ecc71',
            'attachments': '#9b59b6',
            'ammo': '#f39c12',
            'throwable': '#1abc9c'
        };
        return colors[category] || '#666';
    }
    
    function showAlert(message, type = 'info') {
        // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        document.querySelectorAll('.alert').forEach(alert => {
            if (alert.parentNode) alert.parentNode.removeChild(alert);
        });
        
        const alertDiv = document.createElement('div');
        alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
        alertDiv.style.cssText = 'position: fixed; top: 100px; right: 20px; z-index: 9999; min-width: 300px;';
        alertDiv.innerHTML = `
            ${message}
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="alert"></button>
        `;
        
        document.body.appendChild(alertDiv);
        
        setTimeout(() => {
            if (alertDiv.parentNode) {
                alertDiv.remove();
            }
        }, 5000);
    }
    
    function showOrderNotification(success, message) {
        const notification = document.getElementById('order-notification');
        if (!notification) return;
        
        const messageElement = document.getElementById('notification-message');
        if (messageElement) {
            messageElement.textContent = message;
        }
        
        notification.style.display = 'flex';
        
        setTimeout(() => {
            notification.style.display = 'none';
        }, 5000);
    }
    
    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –≤–∫–ª–∞–¥–∫–∏
    window.addEventListener('beforeunload', function() {
        saveCart();
        localStorage.setItem('divers_orders', JSON.stringify(orderHistory));
    });
</script>
</body>
</html>